import os
import re
import logging
from aiogram import Bot, Dispatcher, types
from aiogram.utils import executor

API_TOKEN = os.getenv("API_TOKEN")
CHAT_ID = int(os.getenv("CHAT_ID"))

logging.basicConfig(level=logging.INFO)
bot = Bot(token=API_TOKEN)
dp = Dispatcher(bot)

user_data = {}

TARIFFS = {
    "–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç - –≤–∞—Ä—ñ–∞–Ω—Ç ‚Ññ1\n(3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ, –ø–æ—Ç—ñ–º 250 –≥—Ä–Ω/–º—ñ—Å.)":
        "–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç (3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ)",

    "–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç - –≤–∞—Ä—ñ–∞–Ω—Ç ‚Ññ2\n(6 –º—ñ—Å—è—Ü—ñ–≤ –ø–æ 125 –≥—Ä–Ω, –ø–æ—Ç—ñ–º 250 –≥—Ä–Ω/–º—ñ—Å.)":
        "–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç (6 –º—ñ—Å—è—Ü—ñ–≤ –ø–æ 125 –≥—Ä–Ω)",

    "–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç +TV Start\n(3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ, –ø–æ—Ç—ñ–º 300 –≥—Ä–Ω/–º—ñ—Å.)":
        "–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç +TV Start (3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ, –ø–æ—Ç—ñ–º 300 –≥—Ä–Ω/–º—ñ—Å.)",
    
    "–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç +TV Pro\n(3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ, –ø–æ—Ç—ñ–º 325 –≥—Ä–Ω/–º—ñ—Å.)":
        "–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç +TV Pro (3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ, –ø–æ—Ç—ñ–º 325 –≥—Ä–Ω/–º—ñ—Å.)",

    "–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç +TV Max\n(3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ, –ø–æ—Ç—ñ–º 375 –≥—Ä–Ω/–º—ñ—Å.)":
        "–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç +TV Max (3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ, –ø–æ—Ç—ñ–º 375 –≥—Ä–Ω/–º—ñ—Å.)"
}

# üîé –ü—Ä–æ–≤–µ—Ä–∫–∞ –§–Ü–û
def is_valid_full_name(text):
    return bool(re.match(r"^[–ê-–Ø–Ü–á–Ñ“ê][–∞-—è—ñ—ó—î“ë']+\s[–ê-–Ø–Ü–á–Ñ“ê][–∞-—è—ñ—ó—î“ë']+\s[–ê-–Ø–Ü–á–Ñ“ê][–∞-—è—ñ—ó—î“ë']+$", text.strip()))

# üîé –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
def is_valid_phone(phone):
    return bool(re.match(r"^380\d{9}$", phone.strip()))

@dp.message_handler(commands=['start'])
async def start(message: types.Message):
    user_data[message.chat.id] = {}
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add("–ó–∞–ª–∏—à–∏—Ç–∏ –∑–∞—è–≤–∫—É")

    await bot.send_photo(
        message.chat.id,
        "https://www.vodafone.ua/storage/editor/fotos/7f387e69a10a3da04355e7cf885e59c5_1741849417.jpg"
    )

    await message.answer(
        "üëã *–í—ñ—Ç–∞—î–º–æ —É Vodafone üá∫üá¶*\n\n"
        "üëª *–Ø –í–∞—à –±–æ—Ç –¢–∞—Ä–∞—Å*\n"
        "üí™  *–ü–µ—Ä–µ–≤–∞–≥–∏ –¥–æ–º–∞—à–Ω—å–æ–≥–æ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É –≤—ñ–¥ Vodafone —Ü–µ...*\n"
        "‚úÖ *–ù–æ–≤–∞ —Ç–∞ —è–∫—ñ—Å–Ω–∞ –º–µ—Ä–µ–∂–∞!*\n"
        "‚úÖ *C—É—á–∞—Å–Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è GPON!*\n"
        "‚úÖ *–®–≤–∏–¥–∫—ñ—Å—Ç—å 1–ì—ñ–≥–∞–±—ñ—Ç/—Å–µ–∫.!*\n"
        "‚úÖ *–ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–µ —Ç–∞ —à–≤–∏–¥–∫–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è!*\n"
        "‚úÖ *–ü–æ–Ω–∞–¥ 72 –≥–æ–¥–∏–Ω–∏ –ø—Ä–∞—Ü—é—î –±–µ–∑ —Å–≤—ñ—Ç–ª–∞!*\n"
        "‚úÖ *–ê–∫—Ü—ñ–π–Ω—ñ —Ç–∞—Ä–∏—Ñ–∏!*\n\n"
        "üëâ *–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç  - –≤–∞—Ä—ñ–∞–Ω—Ç ‚Ññ1*\n"
        "*3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ*, –¥–∞–ª—ñ 250 –≥—Ä–Ω/–º—ñ—Å.\n\n"
        "üëâ *–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç - –≤–∞—Ä—ñ–∞–Ω—Ç ‚Ññ2*\n"
        "*6 –º—ñ—Å—è—Ü—ñ–≤ –ø–æ 125 –≥—Ä–Ω/–º—ñ—Å.*, –¥–∞–ª—ñ 250 –≥—Ä–Ω/–º—ñ—Å.\n\n"
        "üëâ *–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç + TV Start *\n"
        "*3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ*, –¥–∞–ª—ñ 300 –≥—Ä–Ω/–º—ñ—Å.\n\n"
        "üëâ *–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç + TV Pro*\n"
        "*3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ*, –¥–∞–ª—ñ 325 –≥—Ä–Ω/–º—ñ—Å.\n\n"
        "üëâ *–î–æ–º–∞—à–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç + TV Max*\n"
        "*3 –º—ñ—Å—è—Ü—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ*, –¥–∞–ª—ñ 375 –≥—Ä–Ω/–º—ñ—Å.\n\n"
        "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å ¬´–ó–∞–ª–∏—à–∏—Ç–∏ –∑–∞—è–≤–∫—É¬ª, —â–æ–± –ø–æ—á–∞—Ç–∏.",
        reply_markup=markup,
        parse_mode="Markdown"
    )

@dp.message_handler(lambda message: message.text == "–ó–∞–ª–∏—à–∏—Ç–∏ –∑–∞—è–≤–∫—É")
async def get_name(message: types.Message):
    user_data[message.chat.id] = {}
    await message.answer("–í–≤–µ–¥—ñ—Ç—å –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∞—à–µ –ø—Ä—ñ–∑–≤–∏—â–µ, —ñ–º'—è —Ç–∞ –ø–æ –±–∞—Ç—å–∫–æ–≤—ñ\n(–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: –¢–∞—Ä–∞—Å–æ–≤ –¢–∞—Ä–∞—Å –¢–∞—Ä–∞—Å–æ–≤–∏—á):")

@dp.message_handler(lambda_
